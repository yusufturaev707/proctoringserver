import time

import requests
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from rest_framework.permissions import AllowAny

from apps.exams.models import Test
from apps.exams.serializers import TestSerializer
from core.api_service import TestAPIClient


class LoadTestsAPIView(APIView):
    permission_classes = [AllowAny]

    def get(self, request):
        try:
            queryset = Test.objects.filter(status=1).order_by('-id')
            serializer = TestSerializer(queryset, many=True)

            data = {
                "status": "success",
                "data": serializer.data,
                "message": "Testlar ro'yxati muvaffaqiyatli yuklab olindi!"
            }
            return Response(data, status=status.HTTP_200_OK)
        except Exception as e:
            print(f"XXX: {e}")
            data = {"status": "error", "data": None, "message": str(e)}
            return Response(data, status=status.HTTP_500_INTERNAL_SERVER_ERROR)



class CheckCandidateAPIView(APIView):
    permission_classes = [AllowAny]

    def get(self, request):
        try:
            imei = request.GET.get('imei')
            test_key = request.GET.get('test_key')
            
            if not imei:
                response_data = {"status": False, "message": "IMEI kiritilmadi!"}
                return Response(response_data, status=status.HTTP_400_BAD_REQUEST)

            if not test_key:
                response_data = {"status": False, "message": "Test tanlanmadi!"}
                return Response(response_data, status=status.HTTP_400_BAD_REQUEST)
            
            # MinScore tekshiruvi

            
            # Test mavjudligini tekshirish
            test = Test.objects.filter(key=test_key).first()
            if not test:
                response_data = {"status": False, "message": "Test topilmadi!"}
                return Response(response_data, status=status.HTTP_400_BAD_REQUEST)

            # External api ga bog'lanish
            student_api = TestAPIClient()
            data = student_api.verify_candidate(imei, test.key)

            if data.get('status') != 1:
                response_data = {"status": False, "message": str(data["message"])}
                return Response(response_data, status=status.HTTP_400_BAD_REQUEST)

            item = data.get('data', {})
            response_data = {
                "status": item['status'],
                "image_base64": item.get('image_base64', ''),
                "imei": item.get('imie', ''),
                "test_link": item.get('test_link', ''),
                "message": item.get('message', '123')

                # "status": True,
                # "image_base64": "data:image/jpeg;base64,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",
                # "test_link": 'https://ntest.uzbmb.uz/',
            }
            return Response(response_data, status=status.HTTP_200_OK)
            
        except requests.RequestException as e:
            response_data = {"status": False, "message": f"External API server bilan bog'lanishda xatolik: {e}"}
            return Response(response_data, status=status.HTTP_500_INTERNAL_SERVER_ERROR)
            
        except Exception as e:
            import traceback
            traceback.print_exc()
            response_data = {"status": False, "message": str(e)}
            return Response(response_data, status=status.HTTP_500_INTERNAL_SERVER_ERROR)